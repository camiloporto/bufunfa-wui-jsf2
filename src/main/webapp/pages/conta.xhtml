<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.prime.com.tr/ui">
<h:head>

</h:head>
<h:body>
	<ui:composition template="_template.xhtml">
		<ui:param name="pageTitle" value="Contas" />
		<ui:define name="pageContent">
			<h:form id="contaForm" prependId="false">
				<p:dialog header="Informe os dados da conta:" id="contaDialog"
					showEffect="bounce" hideEffect="explode" widgetVar="contaDataDialog">
					
					<h:outputText value="#{contaView.treeTableWidget.selectedItem.nomeConta}" /><br/>
					<h:outputText value="nome:" />
					<h:inputText value="#{contaView.treeTableWidget.editingItem.nomeConta}" /><br/>
					<h:outputText value="descricao:" />
					<h:inputText value="#{contaView.treeTableWidget.editingItem.descricaoConta}" /><br/>
					
					<p:commandButton value="confirma" oncomplete="contaDataDialog.hide()" 
						action="#{contaView.treeTableWidget.saveItem}" update="contaTree" />
					<p:commandButton value="cancela" oncomplete="contaDataDialog.hide()" />
				</p:dialog>
			
				<p:treeTable value="#{contaView.treeTableWidget.rootNode}" var="item" id="contaTree">
					<p:column>
						<f:facet name="header">
							Nome
						</f:facet>
						<h:outputText value="#{item.nomeConta}" />
					</p:column>
					<p:column>
						<f:facet name="header">
							Descricao
						</f:facet>
						<h:outputText value="#{item.descricaoConta}" />
					</p:column>
					<p:column>
						<f:facet name="header">
							Acao
						</f:facet>
						<h:panelGroup rendered="#{not item.firstLevel}">
							<p:commandLink action="#{contaView.treeTableWidget.deleteItem}" 
								value="[delete]" update="contaForm" rendered="#{item.leaf}">
								<f:setPropertyActionListener 
									target="#{contaView.treeTableWidget.selectedItem}" 
									value="#{item}" />
							</p:commandLink>
							<p:commandLink oncomplete="contaDataDialog.show()"
								value="[add]" type="button" update="contaDialog" action="#{contaView.treeTableWidget.showNewItemForm}">
								<f:setPropertyActionListener 
									target="#{contaView.treeTableWidget.selectedItem}" 
									value="#{item}" />
								<f:setPropertyActionListener 
									target="#{contaView.treeTableWidget.editing}" 
									value="false" />
							</p:commandLink>
							<p:commandLink oncomplete="contaDataDialog.show()"
								value="[update]" type="button" update="contaDialog" action="#{contaView.treeTableWidget.showEditItemForm}">
								<f:setPropertyActionListener 
									target="#{contaView.treeTableWidget.selectedItem}" 
									value="#{item}" />
								<f:setPropertyActionListener 
									target="#{contaView.treeTableWidget.editing}" 
									value="true" />
							</p:commandLink>
						</h:panelGroup>
					</p:column>
					
				</p:treeTable>
			</h:form>
		</ui:define>
	</ui:composition>
</h:body>
</html>