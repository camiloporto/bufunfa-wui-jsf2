<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.prime.com.tr/ui">
<h:head>
</h:head>
<h:body>
	<ui:composition template="_template.xhtml">
		<ui:param name="pageTitle" value="Contas" />
		<ui:define name="pageContent">
			<p:growl id="statusDialog" showDetail="false"/>
			<h:form id="contaForm" prependId="false">
				
				<p:dialog header="Informe os dados da conta:" id="contaDialog"
					widgetVar="contaDataDialog"
					minWidth="420">
					
					<div class="formContainer">
						
						<h:panelGroup styleClass="parentLabel" rendered="#{contaView.treeTableWidget.editing}">#{contaView.treeTableWidget.selectedItemParent.nomeConta}</h:panelGroup>
						<h:panelGroup styleClass="parentLabel" rendered="#{not contaView.treeTableWidget.editing}">#{contaView.treeTableWidget.selectedItem.nomeConta}</h:panelGroup>
						
						<table>
							<tbody>
								<tr>
									<td class="label"><label for="nomeConta">Nome:</label></td>
									<td><h:inputText value="#{contaView.treeTableWidget.editingItem.nomeConta}" id="nomeConta"/></td>
								</tr>
								<tr>
									<td class="label"><label for="descricaoConta">Descrição:</label></td>
									<td><h:inputText value="#{contaView.treeTableWidget.editingItem.descricaoConta}" id="descricaoConta"/></td>
								</tr>
								<tr>
									<td></td>
									<td><p:commandButton value="confirma" oncomplete="contaDataDialog.hide()" 
											action="#{contaView.treeTableWidget.saveItem}" update="contaTree statusDialog" /></td>
									
								</tr>
							</tbody>
						</table>
					</div>
					
				</p:dialog>
			
				<p:treeTable value="#{contaView.treeTableWidget.rootNode}" var="item" id="contaTree">
					<p:column>
						<f:facet name="header">
							Nome
						</f:facet>
						<h:outputText value="#{item.nomeConta}" />
					</p:column>
					<p:column>
						<f:facet name="header">
							Descricao
						</f:facet>
						<h:outputText value="#{item.descricaoConta}" />
					</p:column>
					<p:column>
						<f:facet name="header">
							Acao
						</f:facet>
						
						<div onmouseover="toggleVisibility(this)" onmouseout="toggleVisibility(this)">
							<h:panelGroup id="actionPanel">
								<p:commandLink oncomplete="contaDataDialog.show()" styleClass="actionLink"
									value="add" type="button" update="contaDialog" title="Nova conta"
									action="#{contaView.treeTableWidget.showNewItemForm}">
									<f:setPropertyActionListener 
										target="#{contaView.treeTableWidget.selectedItem}" 
										value="#{item}" />
									<f:setPropertyActionListener 
										target="#{contaView.treeTableWidget.editing}" 
										value="false" />
								</p:commandLink>
								<p:commandLink oncomplete="contaDataDialog.show()" rendered="#{not item.firstLevel}"
									value="edit" type="button" update="contaDialog" styleClass="actionLink"
									action="#{contaView.treeTableWidget.showEditItemForm}" title="Editar conta">
									<f:setPropertyActionListener 
										target="#{contaView.treeTableWidget.selectedItem}" 
										value="#{item}" />
									<f:setPropertyActionListener 
										target="#{contaView.treeTableWidget.editing}" 
										value="true" />
								</p:commandLink>
								<p:commandLink action="#{contaView.treeTableWidget.deleteItem}" styleClass="actionLink"
									value="remove" update="contaForm statusDialog" 
									rendered="#{(item.leaf) and (not item.firstLevel)}" title="Remover conta">
									<f:setPropertyActionListener 
										target="#{contaView.treeTableWidget.selectedItem}" 
										value="#{item}" />
								</p:commandLink>
								
							</h:panelGroup>
						</div>
						
					</p:column>
					
				</p:treeTable>
			</h:form>
		</ui:define>
	</ui:composition>
</h:body>
</html>